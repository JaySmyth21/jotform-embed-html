<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your JotForm with Dynamic Logic</title>
</head>
<body>
    <h1>Your JotForm</h1>
    <!-- Embed your JotForm here -->
    <iframe src="https://form.jotform.com/242687434974269" style="width:100%; height:600px;" frameborder="0"></iframe>
<script>
   

 window.addEventListener("message", function(event) {
    console.log("Received message:", event.data); // Log the entire message received

    // Split the incoming message based on ": " to separate the different components
    const parsedData = event.data.split(": ");

    // Check if it's a height message
    if (parsedData[0] === "setHeight") {
        console.log("Height message received:", parsedData);
        return; // Exit the function early for height messages
    }

    console.log("Parsed data:", parsedData); // Log the parsed data

    // Continue with the existing logic for resource status messages
    if (parsedData.length === 4) {
        const fieldPrefix = parsedData[0]; // Get the unique name (e.g., "piercerstatus")
        const fieldName = parsedData[1]; // Get the field name (e.g., "Piercer")
        const resourceName = parsedData[2].trim(); // Get the resource name and trim whitespace
        const resourceStatus = parsedData[3].trim(); // Get the resource status and trim whitespace

        console.log(`Resource Name: ${resourceName}, Resource Status: ${resourceStatus}`); // Log resource details

        // Select the appropriate field based on the prefixed unique name
        let fieldElement;

        if (fieldPrefix === "juniorpiercerstatus") {
            fieldElement = document.querySelector(`[name="q81_juniorpiercerstatus"]`);
            console.log("Trying to find Junior Piercer field:", fieldElement);
        } else if (fieldPrefix === "piercerstatus") {
            fieldElement = document.querySelector(`[name="q80_piercerstatus"]`);
            console.log("Trying to find Piercer field:", fieldElement);
        }

        if (fieldElement) {
            // Update the field's value
            fieldElement.value = resourceStatus; // Set the status in the field
            console.log(`Updated ${fieldName} field with status: ${resourceStatus}`); // Log the update
        } else {
            console.error(`Field element not found for name: ${fieldName}`); // Log if the field is not found
        }
    } else {
        console.error("Received message format is incorrect:", parsedData); // Log if the format is incorrect
    }
});


</script>
</body>
</html>
